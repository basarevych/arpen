<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Documentation Index</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.simplex.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">Documentation</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-arpen_app_base.html">arpen/app/base</a></li><li><a href="module-arpen_app_console.html">arpen/app/console</a></li><li><a href="module-arpen_app_daemon.html">arpen/app/daemon</a></li><li><a href="module-arpen_app_server.html">arpen/app/server</a></li><li><a href="module-arpen_models_base.html">arpen/models/base</a></li><li><a href="module-arpen_models_mongo.html">arpen/models/mongo</a></li><li><a href="module-arpen_models_mysql.html">arpen/models/mysql</a></li><li><a href="module-arpen_models_postgres.html">arpen/models/postgres</a></li><li><a href="module-arpen_repositories_base.html">arpen/repositories/base</a></li><li><a href="module-arpen_repositories_mongo.html">arpen/repositories/mongo</a></li><li><a href="module-arpen_repositories_mysql.html">arpen/repositories/mysql</a></li><li><a href="module-arpen_repositories_postgres.html">arpen/repositories/postgres</a></li><li><a href="module-arpen_services_cacher.html">arpen/services/cacher</a></li><li><a href="module-arpen_services_emailer.html">arpen/services/emailer</a></li><li><a href="module-arpen_services_filer.html">arpen/services/filer</a></li><li><a href="module-arpen_services_ini.html">arpen/services/ini</a></li><li><a href="module-arpen_services_logger.html">arpen/services/logger</a></li><li><a href="module-arpen_services_mongo.html">arpen/services/mongo</a></li><li><a href="module-arpen_services_mysql.html">arpen/services/mysql</a></li><li><a href="module-arpen_services_postgres-pubsub.html">arpen/services/postgres-pubsub</a></li><li><a href="module-arpen_services_postgres.html">arpen/services/postgres</a></li><li><a href="module-arpen_services_pubsub.html">arpen/services/pubsub</a></li><li><a href="module-arpen_services_redis-pubsub.html">arpen/services/redis-pubsub</a></li><li><a href="module-arpen_services_redis.html">arpen/services/redis</a></li><li><a href="module-arpen_services_runner.html">arpen/services/runner</a></li><li><a href="module-arpen_services_session.html">arpen/services/session</a></li><li><a href="module-arpen_services_util.html">arpen/services/util</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-arpen_app_base-App.html">arpen/app/base~App</a></li><li><a href="module-arpen_app_console-Console.html">arpen/app/console~Console</a></li><li><a href="module-arpen_app_daemon-Daemon.html">arpen/app/daemon~Daemon</a></li><li><a href="module-arpen_app_server-Server.html">arpen/app/server~Server</a></li><li><a href="module-arpen_models_base-BaseModel.html">arpen/models/base~BaseModel</a></li><li><a href="module-arpen_models_mongo-MongoModel.html">arpen/models/mongo~MongoModel</a></li><li><a href="module-arpen_models_mysql-MysqlModel.html">arpen/models/mysql~MysqlModel</a></li><li><a href="module-arpen_models_postgres-PostgresModel.html">arpen/models/postgres~PostgresModel</a></li><li><a href="module-arpen_repositories_base-BaseRepository.html">arpen/repositories/base~BaseRepository</a></li><li><a href="module-arpen_repositories_mongo-MongoRepository.html">arpen/repositories/mongo~MongoRepository</a></li><li><a href="module-arpen_repositories_mysql-MySQLRepository.html">arpen/repositories/mysql~MySQLRepository</a></li><li><a href="module-arpen_repositories_postgres-PostgresRepository.html">arpen/repositories/postgres~PostgresRepository</a></li><li><a href="module-arpen_services_cacher-Cacher.html">arpen/services/cacher~Cacher</a></li><li><a href="module-arpen_services_emailer-Emailer.html">arpen/services/emailer~Emailer</a></li><li><a href="module-arpen_services_filer-Filer.html">arpen/services/filer~Filer</a></li><li><a href="module-arpen_services_ini-Ini.html">arpen/services/ini~Ini</a></li><li><a href="module-arpen_services_logger-Logger.html">arpen/services/logger~Logger</a></li><li><a href="module-arpen_services_mongo-MongoClient.html">arpen/services/mongo~MongoClient</a></li><li><a href="module-arpen_services_mongo-Mongo.html">arpen/services/mongo~Mongo</a></li><li><a href="module-arpen_services_mysql-MySQLClient.html">arpen/services/mysql~MySQLClient</a></li><li><a href="module-arpen_services_mysql-MySQL.html">arpen/services/mysql~MySQL</a></li><li><a href="module-arpen_services_postgres-pubsub-PostgresPubSub.html">arpen/services/postgres-pubsub~PostgresPubSub</a></li><li><a href="module-arpen_services_postgres-PostgresClient.html">arpen/services/postgres~PostgresClient</a></li><li><a href="module-arpen_services_postgres-Postgres.html">arpen/services/postgres~Postgres</a></li><li><a href="module-arpen_services_pubsub-PubSubClient.html">arpen/services/pubsub~PubSubClient</a></li><li><a href="module-arpen_services_pubsub-PubSub.html">arpen/services/pubsub~PubSub</a></li><li><a href="module-arpen_services_redis-pubsub-RedisPubSub.html">arpen/services/redis-pubsub~RedisPubSub</a></li><li><a href="module-arpen_services_redis-RedisQueue.html">arpen/services/redis~RedisQueue</a></li><li><a href="module-arpen_services_redis-RedisClient.html">arpen/services/redis~RedisClient</a></li><li><a href="module-arpen_services_redis-Redis.html">arpen/services/redis~Redis</a></li><li><a href="module-arpen_services_runner-Subprocess.html">arpen/services/runner~Subprocess</a></li><li><a href="module-arpen_services_runner-Runner.html">arpen/services/runner~Runner</a></li><li><a href="module-arpen_services_session-Session.html">arpen/services/session~Session</a></li><li><a href="module-arpen_services_util-Util.html">arpen/services/util~Util</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-8">
	
		<div id="main">
			

	
	











	
	





    <section class="readme-section">
        <article><h1>Arpen</h1><p>Arpen is a Node.js micro-framework with class autoloading and dependency
injection. It is purpose is to aid in creation of non-Express.js
applications.</p>
<h2>Dependency injection</h2><p>Arpen application consists of services. Here is how service looks like:</p>
<pre class="prettyprint source lang-javascript"><code>class MyService {
    constructor(otherService, anotherService) {
        this._otherService = otherService;
        this._anotherService = anotherService;
    }

    static get provides() { return 'myService'; }
    static get requires() { return ['otherService', 'anotherService?']; }

    doStuff() {
        // do something with this._otherService
        // and this._anotherService
    }
}

module.exports = MyService;</code></pre><p>This is a service which is registered in the system by key 'myService'
(<em>provides</em> static property). It requires two other services known as
'otherService' and 'anotherService' (<em>requires</em> static property). The
second one is marked by '?' sign which means that this dependency is
optional: if Arpen won't be able to instantiate it (i.e. it is not
registered) then null will be passed to the constructor instead (for
non-optional dependencies error will be thrown).</p>
<p>Arpen will first instantiate dependencies of the service and pass the
instances to your constructor in the same order as specified by <em>requires</em>
property. You can use this service as a dependency of another service or just
instantiate it with <strong>app.get('myService')</strong>.</p>
<h3>Life cycle</h3><p>The third (optional) static property you can define on a service is
<em>lifecycle</em>. Consider the following example: we have a service A that
depends on B and C, both B and C depend on fourth service - D.</p>
<p>When <em>lifecycle</em> of D is 'perRequest' or not specified then both B and C
dependencies of A will receive the same instance of D when A is
instantiated. So D is instantiated only once <em>per request</em> of instantiating
A.</p>
<p>But if you run <strong>app.get('A')</strong> another time it will be new <em>request</em>
and B and C of A will receive different instance of D when instantiating
new A (but, again, both B and C will receive the same D just like in
previous <strong>app.get('A')</strong>).</p>
<p>Another possible value of <em>lifecycle</em> is 'unique': B and C will always
receive brand new D. And another one is 'singleton': D will be instantiated
only once during the whole life of the app.</p>
<h3>Additional parameters</h3><p>If you change the constructor in the example above to this, you can pass
additional parameters to your service.</p>
<pre class="prettyprint source lang-javascript"><code>    constructor(otherService, anotherService, value1, value2) {
        // ...
    }</code></pre><p>Now you can run <strong>app.get('A', 'abc', 123)</strong> and <strong>value1</strong> will be 'abc'
and <strong>value2</strong> will be 123.</p>
<p>Services instantiated as dependencies (via <em>requires</em> property) and not
via <strong>app.get()</strong> cannot have additional parameters (they will be
<strong>undefined</strong>).</p>
<h3>Manual registration and instantiation</h3><p>Usually you let Arpen find, load and register your services. But you
can also do this by hand. Add a dependency on 'app' service which is
instance of the application. Now your service can call <strong>app.get()</strong> to
instantiate a known service or <strong>app.registerClass(classFunc)</strong>
and <strong>app.registerInstance(obj, name)</strong> to register services.</p>
<p>.get() accepts a string or a regular expression of the service(s) to
instantiate. In RegExp case a Map of services is returned. </p>
<p>.registerClass() is what is called on your class-exportig files.
.registerInstance() will register any JavaScript variable as a service.
For example:</p>
<pre class="prettyprint source lang-javascript"><code>// In one service
let map = new Map();
map.add('key', 'value');
app.registerInstance(map, 'myMapService');

// In another service
let map = app.get('myMapService');
console.log(map.get('key'));</code></pre><p>Basically instance services behave just like singleton classes.</p>
<h2>Class autoloading</h2><p>At the top level of your application 'config' directory should exit.
It must contain at least 'global.js' file and optionally 'local.js' file.</p>
<p>When application is started global and local files are merged to create
configuration object of the application (both files should <em>export</em>
plain JS object with the configuration parameters). Usually global file
is submitted into the repository and the local one is excluded from the
repo so passwords can be stored in it.</p>
<p>One possible configuration is to put 'autoload' parameter to global file.
This is an array of paths relative to project root that will be searched
for services. If path starts with '~' symbol then it is loaded from
'node_modules' directory and not from the project root. Paths starting
with '!' symbol define what will be excluded when autoloading.</p>
<pre class="prettyprint source"><code>autoload: [
    '~arpen/src',               // load Arpen services
    'src',                      // app services are in 'src' subdir
    '!src/not-this-one',        // skip 'not-this-one' dir in 'src'
],</code></pre><p>Another important configuration parameter is 'modules' (you can put it
into local configuration file, for example). This is a list of modules of
your application.</p>
<p>Modules defined in your configuration are searched for in 'modules'
subdirectory relative to project root. Each module is a directory with
the same 'config' subdirectory just like the main project. It should
contain at least 'global.js' with 'autoload' parameter.</p>
<p>Usually you put project-wide files in 'src' directory of project root
and module-specific code in 'src' relative to a module directory (don't
forget to autoload it!)</p>
<p>Your module should define one service with service name like
'modules.someModule' - replace 'someModule' with a unique name (no dots).</p>
<p>During initialization of the app this service will be instantiated and its
.bootstrap() method will be called (if it exists) which should return a
Promise.</p>
<h2>See it in action!</h2><pre class="prettyprint source"><code>$ sudo npm install arpen -g --unsafe-perm</code></pre><p>--unsafe-perm is needed for some C++ dependencies to compile.</p>
<pre class="prettyprint source"><code>$ arpen new my-project
$ cd my-project
$ npm install
$ ./bin/run udp</code></pre><p>This is how to create and run a skeleton project. It includes one simple server
Udp which listens for UDP commands. Test it:</p>
<pre class="prettyprint source"><code>$ nc -u localhost 3000
uppercase hello world
HELLO WORLD
^C</code></pre><p>To keep it simple it understands just one command: uppercase. </p>
<p>This sample project has just one module 'udp' which defines one server (Udp)
which listens for one event (Uppercase).</p>
<p>Have a look at <strong>modules/udp/src/servers/udp.js</strong> file - it is the server.
Directory <strong>modules/udp/src/events</strong> contains the events of the server.</p>
<h2>Servers</h2><p>Server is a service which has these methods:</p>
<p>.init(name) — called when app is instantiated</p>
<p>.start(name) — called when the app is started</p>
<p>.stop(name) — called when the app is stopped</p>
<p><strong>name</strong> is the name of the server in the configuration. If you look at the
skeleton project <strong>local.js</strong> config you will find the following section:</p>
<pre class="prettyprint source"><code>    // Servers
    servers: {
        udp: {
            class: 'servers.udp',
            host: &quot;0.0.0.0&quot;,
            port: 3000,
        },
    },</code></pre><p>This is how you define your servers, each entry should have at least <em>class</em>
key, which is the service name of the server. The rest of keys are all up to
you: they depend on what your server expects.</p>
<p>You can retrieve this configuration by adding dependency on 'config' service:</p>
<pre class="prettyprint source"><code>let name = 'udp';
let port = config.get(`servers.${name}.port`);</code></pre><h2>Commands</h2><p>Another feature of Arpen is console commands. The skeleton project includes
a couple of them, you can find them in <strong>src/commands</strong> directory.</p>
<p>Try running:</p>
<pre class="prettyprint source"><code>$ ./bin/cmd help create-cert
$ ./bin/cmd create-cert 192.168.0.1</code></pre><h2>Bundled services</h2><p>See jsDoc: https://basarevych.github.io/arpen</p></article>
    </section>







		</div>
	</div>

	<div class="clearfix"></div>

	
		<div class="col-md-3">
			<div id="toc" class="col-md-3 hidden-xs hidden-sm hidden-md"></div>
		</div>
	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
	
		on 2017-11-07T12:06:07+02:00
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : false,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>